hNode = function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=4)}([function(e,n,r){var t=r(1),o=r(2),s=r(5),i=r(3);o.set({precision:64});var c=function(e){var n=nacl.encode_utf8(e.txtdata),r=nacl.crypto_box(n,e.sessionNonce,e.serverSessionPubKey,e.clientSessionSecKey),o=nacl.to_hex(r);return e.sessionID+"/"+e.step+"/"+t.safeCompress(o)},a=function(e,n,r){var t=document.querySelector("#session_data").textContent,o=f(e,n,t);return c({sessionID:o.sessionID,sessionNonce:o.sessionNonce,serverSessionPubKey:o.serverSessionPubKey,clientSessionSecKey:o.clientSessionSecKey,step:n,txtdata:r})},u=function(e){var n,r=t.safeDecompress(e.encdata);if(null!=r){var o=nacl.from_hex(r),s=nacl.crypto_box_open(o,e.sessionNonce,e.serverSessionPubKey,e.clientSessionSecKey);n=nacl.decode_utf8(s)}else n=null;return n},l=function(e,n,r){var t=document.querySelector("#session_data").textContent,o=null;if(null!==r){var s=f(e,n,t);o=u({encdata:r,sessionNonce:s.sessionNonce,serverSessionPubKey:s.serverSessionPubKey,clientSessionSecKey:s.clientSessionSecKey})}return o},f=function(e,n,r){var t=i.readSession(e.user_keys,e.nonce,r,h),c=t.session_pubsign,a=nacl.from_hex(t.server_pubkey),u=nacl.from_hex(t.session_seckey),l=new o(s.toDec(t.nonce1)),f=new o(s.toDec(t.nonce2)),d=new o(n),p=l.plus(f).plus(d).toDecimalPlaces(64),g=s.toHex(p.toFixed(0).toString()),v=g.substr(2,g.length);return{sessionID:c,clientSessionSecKey:u,serverSessionPubKey:a,sessionNonce:nacl.from_hex(v)}};function h(){console.log("Error: Could not retrieve session data.")}e.exports={path:function(e,n,r){return"y/"+a(e,n,r)},obj:function(e,n,r){return JSON.parse(l(e,n,r))},decode_sub:u,decode:l,encode_sub:c,encode:a,getGeneralSessionData:f}},function(e,n,r){var t,o=function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",Encode:function(n){var r,t,o,s,i,c,a,u="",l=0;for(n=e._utf8_encode(n);l<n.length;)s=(r=n.charCodeAt(l++))>>2,i=(3&r)<<4|(t=n.charCodeAt(l++))>>4,c=(15&t)<<2|(o=n.charCodeAt(l++))>>6,a=63&o,isNaN(t)?c=a=64:isNaN(o)&&(a=64),u=u+this._keyStr.charAt(s)+this._keyStr.charAt(i)+this._keyStr.charAt(c)+this._keyStr.charAt(a);return u},Decode:function(n){var r,t,o,s,i,c,a="",u=0;if(void 0!==n){for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<n.length;)r=this._keyStr.indexOf(n.charAt(u++))<<2|(s=this._keyStr.indexOf(n.charAt(u++)))>>4,t=(15&s)<<4|(i=this._keyStr.indexOf(n.charAt(u++)))>>2,o=(3&i)<<6|(c=this._keyStr.indexOf(n.charAt(u++))),a+=String.fromCharCode(r),64!=i&&(a+=String.fromCharCode(t)),64!=c&&(a+=String.fromCharCode(o));a=e._utf8_decode(a)}else a=void 0;return a},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var n="",r=0;r<e.length;r++){var t=e.charCodeAt(r);t<128?n+=String.fromCharCode(t):t>127&&t<2048?(n+=String.fromCharCode(t>>6|192),n+=String.fromCharCode(63&t|128)):(n+=String.fromCharCode(t>>12|224),n+=String.fromCharCode(t>>6&63|128),n+=String.fromCharCode(63&t|128))}return n},_utf8_decode:function(e){for(var n="",r=0,t=c1=c2=0;r<e.length;)(t=e.charCodeAt(r))<128?(n+=String.fromCharCode(t),r++):t>191&&t<224?(c2=e.charCodeAt(r+1),n+=String.fromCharCode((31&t)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),n+=String.fromCharCode((15&t)<<12|(63&c2)<<6|63&c3),r+=3);return n},atob:function(e){if(this._keyStr.split(""),/(=[^=]+|={3,})$/.test(e))throw new Error("String contains an invalid character");var n=3&(e=e.replace(/=/g,"")).length;if(1===n)throw new Error("String contains an invalid character");for(var r=0,t=0,o=e.length/4,s=[];r<o;++r){var i=_keyStr.indexOf(e[t++]||"A"),c=_keyStr.indexOf(e[t++]||"A"),a=_keyStr.indexOf(e[t++]||"A"),u=_keyStr.indexOf(e[t++]||"A");if((i|c|a|u)<0)throw new Error("String contains an invalid character");s[s.length]=255&(i<<2|c>>4),s[s.length]=255&(c<<4|a>>2),s[s.length]=255&(a<<6|u)}return String.fromCharCode.apply(null,s).substr(0,s.length+n-4)},btoa:function(e){for(var n=this._keyStr.split(""),r=0,t=0,o=e.length/3,s=[];r<o;++r){var i=e.charCodeAt(t++),c=e.charCodeAt(t++),a=e.charCodeAt(t++);if((i|c|a)>255)throw new Error("String contains an invalid character");s[s.length]=n[i>>2]+n[i<<4&63|c>>4]+(isNaN(c)?"=":n[c<<2&63|a>>6])+(isNaN(c+a)?"=":n[63&a])}return s.join("")},hexToBase64:function(e){return btoa(String.fromCharCode.apply(null,e.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")))},base64ToHex:function(e){for(var n=0,r=atob(e.replace(/[ \r\n]+$/,"")),t=[];n<r.length;++n){var o=r.charCodeAt(n).toString(16);1===o.length&&(o="0"+o),t[t.length]=o}return t.join(" ")},safeCompress:function(n){return e.Encode(LZString.compressToEncodedURIComponent(n))},safeDecompress:function(n){return LZString.decompressFromEncodedURIComponent(e.Decode(n))}};return e}();void 0===(t=function(){return o}.call(n,r,n,e))||(e.exports=t)},function(e,n,r){var t;!function(o){"use strict";function s(e,n){var r,t,o,s,i,c,a,u,l=e.constructor,f=l.precision;if(!e.s||!n.s)return n.s||(n=new l(e)),w?p(n,f):n;if(a=e.d,u=n.d,i=e.e,o=n.e,a=a.slice(),s=i-o){for(0>s?(t=a,s=-s,c=u.length):(t=u,o=i,c=a.length),s>(c=(i=Math.ceil(f/D))>c?i+1:c+1)&&(s=c,t.length=1),t.reverse();s--;)t.push(0);t.reverse()}for(0>(c=a.length)-(s=u.length)&&(s=c,t=u,u=a,a=t),r=0;s;)r=(a[--s]=a[s]+u[s]+r)/k|0,a[s]%=k;for(r&&(a.unshift(r),++o),c=a.length;0==a[--c];)a.pop();return n.d=a,n.e=o,w?p(n,f):n}function i(e,n,r){if(e!==~~e||n>e||e>r)throw Error(N+e)}function c(e){var n,r,t,o=e.length-1,s="",i=e[0];if(o>0){for(s+=i,n=1;o>n;n++)t=e[n]+"",(r=D-t.length)&&(s+=f(r)),s+=t;i=e[n],(r=D-(t=i+"").length)&&(s+=f(r))}else if(0===i)return"0";for(;i%10==0;)i/=10;return s+i}function a(e,n){var r,t,o,s,i,a=0,l=0,f=e.constructor,h=f.precision;if(u(e)>16)throw Error(C+u(e));if(!e.s)return new f(S);for(null==n?(w=!1,i=h):i=n,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),l+=5;for(i+=Math.log(E(2,l))/Math.LN10*2+5|0,r=t=o=new f(S),f.precision=i;;){if(t=p(t.times(e),i),r=r.times(++a),c((s=o.plus(L(t,r,i))).d).slice(0,i)===c(o.d).slice(0,i)){for(;l--;)o=p(o.times(o),i);return f.precision=h,null==n?(w=!0,p(o,h)):o}o=s}}function u(e){for(var n=e.e*D,r=e.d[0];r>=10;r/=10)n++;return n}function l(e,n,r){if(n>e.LN10.sd())throw w=!0,r&&(e.precision=r),Error(b+"LN10 precision limit exceeded");return p(new e(e.LN10),n)}function f(e){for(var n="";e--;)n+="0";return n}function h(e,n){var r,t,o,s,i,a,f,d,g,v=1,y=e,_=y.d,m=y.constructor,x=m.precision;if(y.s<1)throw Error(b+(y.s?"NaN":"-Infinity"));if(y.eq(S))return new m(0);if(null==n?(w=!1,d=x):d=n,y.eq(10))return null==n&&(w=!0),l(m,d);if(d+=10,m.precision=d,t=(r=c(_)).charAt(0),s=u(y),!(Math.abs(s)<15e14))return f=l(m,d+2,x).times(s+""),y=h(new m(t+"."+r.slice(1)),d-10).plus(f),m.precision=x,null==n?(w=!0,p(y,x)):y;for(;7>t&&1!=t||1==t&&r.charAt(1)>3;)t=(r=c((y=y.times(e)).d)).charAt(0),v++;for(s=u(y),t>1?(y=new m("0."+r),s++):y=new m(t+"."+r.slice(1)),a=i=y=L(y.minus(S),y.plus(S),d),g=p(y.times(y),d),o=3;;){if(i=p(i.times(g),d),c((f=a.plus(L(i,new m(o),d))).d).slice(0,d)===c(a.d).slice(0,d))return a=a.times(2),0!==s&&(a=a.plus(l(m,d+2,x).times(s+""))),a=L(a,new m(v),d),m.precision=x,null==n?(w=!0,p(a,x)):a;a=f,o+=2}}function d(e,n){var r,t,o;for((r=n.indexOf("."))>-1&&(n=n.replace(".","")),(t=n.search(/e/i))>0?(0>r&&(r=t),r+=+n.slice(t+1),n=n.substring(0,t)):0>r&&(r=n.length),t=0;48===n.charCodeAt(t);)++t;for(o=n.length;48===n.charCodeAt(o-1);)--o;if(n=n.slice(t,o)){if(o-=t,r=r-t-1,e.e=O(r/D),e.d=[],t=(r+1)%D,0>r&&(t+=D),o>t){for(t&&e.d.push(+n.slice(0,t)),o-=D;o>t;)e.d.push(+n.slice(t,t+=D));n=n.slice(t),t=D-n.length}else t-=o;for(;t--;)n+="0";if(e.d.push(+n),w&&(e.e>U||e.e<-U))throw Error(C+r)}else e.s=0,e.e=0,e.d=[0];return e}function p(e,n,r){var t,o,s,i,c,a,l,f,h=e.d;for(i=1,s=h[0];s>=10;s/=10)i++;if(0>(t=n-i))t+=D,o=n,l=h[f=0];else{if((f=Math.ceil((t+1)/D))>=(s=h.length))return e;for(l=s=h[f],i=1;s>=10;s/=10)i++;o=(t%=D)-D+i}if(void 0!==r&&(c=l/(s=E(10,i-o-1))%10|0,a=0>n||void 0!==h[f+1]||l%s,a=4>r?(c||a)&&(0==r||r==(e.s<0?3:2)):c>5||5==c&&(4==r||a||6==r&&(t>0?o>0?l/E(10,i-o):0:h[f-1])%10&1||r==(e.s<0?8:7))),1>n||!h[0])return a?(s=u(e),h.length=1,n=n-s-1,h[0]=E(10,(D-n%D)%D),e.e=O(-n/D)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(0==t?(h.length=f,s=1,f--):(h.length=f+1,s=E(10,D-t),h[f]=o>0?(l/E(10,i-o)%E(10,o)|0)*s:0),a)for(;;){if(0==f){(h[0]+=s)==k&&(h[0]=1,++e.e);break}if(h[f]+=s,h[f]!=k)break;h[f--]=0,s=1}for(t=h.length;0===h[--t];)h.pop();if(w&&(e.e>U||e.e<-U))throw Error(C+u(e));return e}function g(e,n){var r,t,o,s,i,c,a,u,l,f,h=e.constructor,d=h.precision;if(!e.s||!n.s)return n.s?n.s=-n.s:n=new h(e),w?p(n,d):n;if(a=e.d,f=n.d,t=n.e,u=e.e,a=a.slice(),i=u-t){for((l=0>i)?(r=a,i=-i,c=f.length):(r=f,t=u,c=a.length),i>(o=Math.max(Math.ceil(d/D),c)+2)&&(i=o,r.length=1),r.reverse(),o=i;o--;)r.push(0);r.reverse()}else{for(o=a.length,(l=(c=f.length)>o)&&(c=o),o=0;c>o;o++)if(a[o]!=f[o]){l=a[o]<f[o];break}i=0}for(l&&(r=a,a=f,f=r,n.s=-n.s),c=a.length,o=f.length-c;o>0;--o)a[c++]=0;for(o=f.length;o>i;){if(a[--o]<f[o]){for(s=o;s&&0===a[--s];)a[s]=k-1;--a[s],a[o]+=k}a[o]-=f[o]}for(;0===a[--c];)a.pop();for(;0===a[0];a.shift())--t;return a[0]?(n.d=a,n.e=t,w?p(n,d):n):new h(0)}function v(e,n,r){var t,o=u(e),s=c(e.d),i=s.length;return n?(r&&(t=r-i)>0?s=s.charAt(0)+"."+s.slice(1)+f(t):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(0>o?"e":"e+")+o):0>o?(s="0."+f(-o-1)+s,r&&(t=r-i)>0&&(s+=f(t))):o>=i?(s+=f(o+1-i),r&&(t=r-o-1)>0&&(s=s+"."+f(t))):((t=o+1)<i&&(s=s.slice(0,t)+"."+s.slice(t)),r&&(t=r-i)>0&&(o+1===i&&(s+="."),s+=f(t))),e.s<0?"-"+s:s}function y(e,n){return e.length>n?(e.length=n,!0):void 0}function _(e){if(!e||"object"!=typeof e)throw Error(b+"Object expected");var n,r,t,o=["precision",1,m,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(n=0;n<o.length;n+=3)if(void 0!==(t=e[r=o[n]])){if(!(O(t)===t&&t>=o[n+1]&&t<=o[n+2]))throw Error(N+r+": "+t);this[r]=t}if(void 0!==(t=e[r="LN10"])){if(t!=Math.LN10)throw Error(N+r+": "+t);this[r]=new this(t)}return this}var S,m=1e9,x={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},w=!0,b="[DecimalError] ",N=b+"Invalid argument: ",C=b+"Exponent out of range: ",O=Math.floor,E=Math.pow,A=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,k=1e7,D=7,P=9007199254740991,U=O(P/D),I={};I.absoluteValue=I.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},I.comparedTo=I.cmp=function(e){var n,r,t,o,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(t=s.d.length,n=0,r=(o=e.d.length)>t?t:o;r>n;++n)if(s.d[n]!==e.d[n])return s.d[n]>e.d[n]^s.s<0?1:-1;return t===o?0:t>o^s.s<0?1:-1},I.decimalPlaces=I.dp=function(){var e=this,n=e.d.length-1,r=(n-e.e)*D;if(n=e.d[n])for(;n%10==0;n/=10)r--;return 0>r?0:r},I.dividedBy=I.div=function(e){return L(this,new this.constructor(e))},I.dividedToIntegerBy=I.idiv=function(e){var n=this.constructor;return p(L(this,new n(e),0,1),n.precision)},I.equals=I.eq=function(e){return!this.cmp(e)},I.exponent=function(){return u(this)},I.greaterThan=I.gt=function(e){return this.cmp(e)>0},I.greaterThanOrEqualTo=I.gte=function(e){return this.cmp(e)>=0},I.isInteger=I.isint=function(){return this.e>this.d.length-2},I.isNegative=I.isneg=function(){return this.s<0},I.isPositive=I.ispos=function(){return this.s>0},I.isZero=function(){return 0===this.s},I.lessThan=I.lt=function(e){return this.cmp(e)<0},I.lessThanOrEqualTo=I.lte=function(e){return this.cmp(e)<1},I.logarithm=I.log=function(e){var n,r=this,t=r.constructor,o=t.precision,s=o+5;if(void 0===e)e=new t(10);else if((e=new t(e)).s<1||e.eq(S))throw Error(b+"NaN");if(r.s<1)throw Error(b+(r.s?"NaN":"-Infinity"));return r.eq(S)?new t(0):(w=!1,n=L(h(r,s),h(e,s),s),w=!0,p(n,o))},I.minus=I.sub=function(e){var n=this;return e=new n.constructor(e),n.s==e.s?g(n,e):s(n,(e.s=-e.s,e))},I.modulo=I.mod=function(e){var n,r=this,t=r.constructor,o=t.precision;if(!(e=new t(e)).s)throw Error(b+"NaN");return r.s?(w=!1,n=L(r,e,0,1).times(e),w=!0,r.minus(n)):p(new t(r),o)},I.naturalExponential=I.exp=function(){return a(this)},I.naturalLogarithm=I.ln=function(){return h(this)},I.negated=I.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},I.plus=I.add=function(e){var n=this;return e=new n.constructor(e),n.s==e.s?s(n,e):g(n,(e.s=-e.s,e))},I.precision=I.sd=function(e){var n,r,t,o=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(N+e);if(n=u(o)+1,r=(t=o.d.length-1)*D+1,t=o.d[t]){for(;t%10==0;t/=10)r--;for(t=o.d[0];t>=10;t/=10)r++}return e&&n>r?n:r},I.squareRoot=I.sqrt=function(){var e,n,r,t,o,s,i,a=this,l=a.constructor;if(a.s<1){if(!a.s)return new l(0);throw Error(b+"NaN")}for(e=u(a),w=!1,0==(o=Math.sqrt(+a))||o==1/0?(((n=c(a.d)).length+e)%2==0&&(n+="0"),o=Math.sqrt(n),e=O((e+1)/2)-(0>e||e%2),t=new l(n=o==1/0?"1e"+e:(n=o.toExponential()).slice(0,n.indexOf("e")+1)+e)):t=new l(o.toString()),o=i=(r=l.precision)+3;;)if(t=(s=t).plus(L(a,s,i+2)).times(.5),c(s.d).slice(0,i)===(n=c(t.d)).slice(0,i)){if(n=n.slice(i-3,i+1),o==i&&"4999"==n){if(p(s,r+1,0),s.times(s).eq(a)){t=s;break}}else if("9999"!=n)break;i+=4}return w=!0,p(t,r)},I.times=I.mul=function(e){var n,r,t,o,s,i,c,a,u,l=this,f=l.constructor,h=l.d,d=(e=new f(e)).d;if(!l.s||!e.s)return new f(0);for(e.s*=l.s,r=l.e+e.e,a=h.length,(u=d.length)>a&&(s=h,h=d,d=s,i=a,a=u,u=i),s=[],t=i=a+u;t--;)s.push(0);for(t=u;--t>=0;){for(n=0,o=a+t;o>t;)c=s[o]+d[t]*h[o-t-1]+n,s[o--]=c%k|0,n=c/k|0;s[o]=(s[o]+n)%k|0}for(;!s[--i];)s.pop();return n?++r:s.shift(),e.d=s,e.e=r,w?p(e,f.precision):e},I.toDecimalPlaces=I.todp=function(e,n){var r=this,t=r.constructor;return r=new t(r),void 0===e?r:(i(e,0,m),void 0===n?n=t.rounding:i(n,0,8),p(r,e+u(r)+1,n))},I.toExponential=function(e,n){var r,t=this,o=t.constructor;return void 0===e?r=v(t,!0):(i(e,0,m),void 0===n?n=o.rounding:i(n,0,8),r=v(t=p(new o(t),e+1,n),!0,e+1)),r},I.toFixed=function(e,n){var r,t,o=this,s=o.constructor;return void 0===e?v(o):(i(e,0,m),void 0===n?n=s.rounding:i(n,0,8),r=v((t=p(new s(o),e+u(o)+1,n)).abs(),!1,e+u(t)+1),o.isneg()&&!o.isZero()?"-"+r:r)},I.toInteger=I.toint=function(){var e=this,n=e.constructor;return p(new n(e),u(e)+1,n.rounding)},I.toNumber=function(){return+this},I.toPower=I.pow=function(e){var n,r,t,o,s,i,c=this,u=c.constructor,l=+(e=new u(e));if(!e.s)return new u(S);if(!(c=new u(c)).s){if(e.s<1)throw Error(b+"Infinity");return c}if(c.eq(S))return c;if(t=u.precision,e.eq(S))return p(c,t);if(i=(n=e.e)>=(r=e.d.length-1),s=c.s,i){if((r=0>l?-l:l)<=P){for(o=new u(S),n=Math.ceil(t/D+4),w=!1;r%2&&y((o=o.times(c)).d,n),0!==(r=O(r/2));)y((c=c.times(c)).d,n);return w=!0,e.s<0?new u(S).div(o):p(o,t)}}else if(0>s)throw Error(b+"NaN");return s=0>s&&1&e.d[Math.max(n,r)]?-1:1,c.s=1,w=!1,o=e.times(h(c,t+12)),w=!0,(o=a(o)).s=s,o},I.toPrecision=function(e,n){var r,t,o=this,s=o.constructor;return void 0===e?t=v(o,(r=u(o))<=s.toExpNeg||r>=s.toExpPos):(i(e,1,m),void 0===n?n=s.rounding:i(n,0,8),t=v(o=p(new s(o),e,n),(r=u(o))>=e||r<=s.toExpNeg,e)),t},I.toSignificantDigits=I.tosd=function(e,n){var r=this.constructor;return void 0===e?(e=r.precision,n=r.rounding):(i(e,1,m),void 0===n?n=r.rounding:i(n,0,8)),p(new r(this),e,n)},I.toString=I.valueOf=I.val=I.toJSON=function(){var e=this,n=u(e),r=e.constructor;return v(e,n<=r.toExpNeg||n>=r.toExpPos)};var L=function(){function e(e,n){var r,t=0,o=e.length;for(e=e.slice();o--;)r=e[o]*n+t,e[o]=r%k|0,t=r/k|0;return t&&e.unshift(t),e}function n(e,n,r,t){var o,s;if(r!=t)s=r>t?1:-1;else for(o=s=0;r>o;o++)if(e[o]!=n[o]){s=e[o]>n[o]?1:-1;break}return s}function r(e,n,r){for(var t=0;r--;)e[r]-=t,t=e[r]<n[r]?1:0,e[r]=t*k+e[r]-n[r];for(;!e[0]&&e.length>1;)e.shift()}return function(t,o,s,i){var c,a,l,f,h,d,g,v,y,_,S,m,x,w,N,C,O,E,A=t.constructor,P=t.s==o.s?1:-1,U=t.d,I=o.d;if(!t.s)return new A(t);if(!o.s)throw Error(b+"Division by zero");for(a=t.e-o.e,O=I.length,N=U.length,v=(g=new A(P)).d=[],l=0;I[l]==(U[l]||0);)++l;if(I[l]>(U[l]||0)&&--a,0>(m=null==s?s=A.precision:i?s+(u(t)-u(o))+1:s))return new A(0);if(m=m/D+2|0,l=0,1==O)for(f=0,I=I[0],m++;(N>l||f)&&m--;l++)x=f*k+(U[l]||0),v[l]=x/I|0,f=x%I|0;else{for((f=k/(I[0]+1)|0)>1&&(I=e(I,f),U=e(U,f),O=I.length,N=U.length),w=O,_=(y=U.slice(0,O)).length;O>_;)y[_++]=0;(E=I.slice()).unshift(0),C=I[0],I[1]>=k/2&&++C;do{f=0,0>(c=n(I,y,O,_))?(S=y[0],O!=_&&(S=S*k+(y[1]||0)),(f=S/C|0)>1?(f>=k&&(f=k-1),1==(c=n(h=e(I,f),y,d=h.length,_=y.length))&&(f--,r(h,d>O?E:I,d))):(0==f&&(c=f=1),h=I.slice()),_>(d=h.length)&&h.unshift(0),r(y,h,_),-1==c&&1>(c=n(I,y,O,_=y.length))&&(f++,r(y,_>O?E:I,_)),_=y.length):0===c&&(f++,y=[0]),v[l++]=f,c&&y[0]?y[_++]=U[w]||0:(y=[U[w]],_=1)}while((w++<N||void 0!==y[0])&&m--)}return v[0]||v.shift(),g.e=a,p(g,i?s+u(g)+1:s)}}();x=function e(n){function r(e){var n=this;if(!(n instanceof r))return new r(e);if(n.constructor=r,e instanceof r)return n.s=e.s,n.e=e.e,void(n.d=(e=e.d)?e.slice():e);if("number"==typeof e){if(0*e!=0)throw Error(N+e);if(e>0)n.s=1;else{if(!(0>e))return n.s=0,n.e=0,void(n.d=[0]);e=-e,n.s=-1}return e===~~e&&1e7>e?(n.e=0,void(n.d=[e])):d(n,e.toString())}if("string"!=typeof e)throw Error(N+e);if(45===e.charCodeAt(0)?(e=e.slice(1),n.s=-1):n.s=1,!A.test(e))throw Error(N+e);d(n,e)}var t,o,s;if(r.prototype=I,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.clone=e,r.config=r.set=_,void 0===n&&(n={}),n)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)n.hasOwnProperty(o=s[t++])||(n[o]=this[o]);return r.config(n),r}(x),S=new x(1),void 0===(t=function(){return x}.call(n,r,n,e))||(e.exports=t)}()},function(module,exports,__webpack_require__){function generateKeys(e,n,r){var t=sjcl.codec.utf8String.toBits(e.toUpperCase()),o=sjcl.codec.utf8String.toBits(n.toLowerCase()),s=sjcl.misc.pbkdf2(t,o,5e3+r,4096,!1),i=e.toUpperCase().split("").reverse().join(""),c=sjcl.codec.utf8String.toBits(i),a=sjcl.codec.utf8String.toBits(n.toUpperCase()),u=sjcl.misc.pbkdf2(c,a,5e3+r,4096,!1),l=sjcl.misc.pbkdf2(s,u,5e3+r,4096,!1),f=sjcl.codec.hex.fromBits(l),h=nacl.from_hex(f);return nacl.crypto_box_keypair_from_seed(h)}function clean(e){if(void 0!==e)var n=e.toString().replace(/[^A-Za-z0-9]/g,"");else n="";return n}function seedGenerator(e,n){function r(e,n){var r="",t=0;for(i=0;i<n.length;i++)r+=String.fromCharCode(n[i].charCodeAt(0).toString(10)^e[t].charCodeAt(0).toString(10)),++t>=e.length&&(t=0);return r}return UrlBase64.Encode(r(nacl.to_hex(e.boxPk),r(n.split(".")[0],r("1nT3rN3t0Fc01NsB1nD5tH3cRyPt05Ph3R3t093Th3Rf0Rp30Pl3L1k3M34nDy0U",nacl.to_hex(e.boxSk))))).slice(0,-2)}function activate(code){return"string"==typeof code?(eval("window.deterministic = (function(){})(); "+code),window.deterministic):(console.log("Cannot activate deterministic code!"),function(){})}function sessionStep1Reply(e,n,r){DEBUG&&console.log("Hello JSON:"+JSON.stringify(e));var t=nacl.from_hex(clean(e.server_sign_pubkey)),o=nacl.from_hex(clean(e.server_session_pubkey)),s=nacl.from_hex(clean(e.current_nonce));DEBUG&&console.log("nonce:"+e.current_nonce);var i=nacl.from_hex(clean(e.crhex));try{var c=nacl.crypto_box_open(i,s,o,n.session_keypair.boxSk);DEBUG&&console.log("Cryptstr:"+JSON.stringify(c));var a=nacl.to_hex(c);DEBUG&&console.log("Crypt hexstr:"+JSON.stringify(a));var u=nacl.from_hex(clean(a)),l=nacl.crypto_sign_open(u,t),f=nacl.decode_utf8(l),h=JSON.parse(f);if(DEBUG&&(console.log("PAYLOAD:"+JSON.stringify(a)),console.log("SIGNLOAD:"+JSON.stringify(f))),h.server_sign_pubkey===e.server_sign_pubkey&&h.server_session_pubkey===e.server_session_pubkey&&h.current_nonce===e.current_nonce){var d={nonce:n.session_nonce,nonce1:n.nonce1_hex,nonce2:n.nonce2_hex,nonce_combi:h.current_nonce,session_secsign:n.session_secsign,session_seckey:n.session_seckey,session_pubsign:n.session_hexsign,session_pubkey:n.session_hexkey,server_pubsign:h.server_sign_pubkey,server_pubkey:h.server_session_pubkey},p=nacl.encode_utf8(JSON.stringify(d));DEBUG&&console.log("Raw session_data: "+JSON.stringify(d));var g=nacl.crypto_box(p,s,n.userKeys.boxPk,n.userKeys.boxSk),v=nacl.to_hex(g);return"function"==typeof r&&r(v),{sess_hex:v,current_nonce:s}}}catch(e){console.error(JSON.stringify(e))}}function readSession(e,n,r,t){null===r&&t();var o=nacl.from_hex(r),s=nacl.crypto_box_open(o,n,e.boxPk,e.boxSk),i=nacl.decode_utf8(s);return JSON.parse(i)}function generateInitialSessionData(e){var n=nacl.random_bytes(4096),r=nacl.crypto_box_keypair_from_seed(n),t=nacl.crypto_hash_sha256(n),o=nacl.crypto_sign_keypair_from_seed(t),s=nacl.to_hex(e),i=nacl.to_hex(r.boxPk),c=nacl.to_hex(o.signPk),a=nacl.to_hex(r.boxSk),u=nacl.to_hex(o.signSk);return DEBUG&&console.log("session_seed:"+n+"("+n.length+")"),DEBUG&&console.log("session_hexkey:"+i+"("+i.length+")"),DEBUG&&console.log("session_sign_seed:"+t+"("+t.length+")"),DEBUG&&console.log("session_hexsign:"+c+"("+c.length+")"),{session_hexkey:i,session_hexsign:c,session_keypair:r,session_nonce:s,session_seckey:a,session_secsign:u,session_signpair:o}}function generateSecondarySessionData(e,n,r){var t,o=nacl.crypto_box_random_nonce(),s=(s=nacl.to_hex(o)).replace(/^[8-9a-f]/,function(e){return["8","9","a","b","c","d","e","f"].indexOf(e)}),i={nonce1:t=(t=clean(e)).replace(/^[8-9a-f]/,function(e){return["8","9","a","b","c","d","e","f"].indexOf(e)}),nonce2:s,client_session_pubkey:n},c=JSON.stringify(i),a=nacl.encode_utf8(c),u=nacl.crypto_sign(a,r),l=nacl.to_hex(u);return DEBUG&&console.log("CR:"+l),{nonce1_hex:t,nonce2_hex:s,crypt_hex:l}}function continueSession(e,n,r,t,o){""===t()?setTimeout(function(){continueSession(e,n,r,t,o)},1e3):o()}function nextStep(){var e=session_step;return session_step++,e+1}function increaseSessionStep(e){return e+1}function validatePasswordLength(e){return void 0!==e&&(16===e.length||48===e.length)}function validateUserIDLength(e){return void 0!==e&&16===e.length}commonUtils={activate:activate,clean:clean,continueSession:continueSession,generateKeys:generateKeys,generateInitialSessionData:generateInitialSessionData,generateSecondarySessionData:generateSecondarySessionData,increaseSessionStep:increaseSessionStep,seedGenerator:seedGenerator,sessionStep1Reply:sessionStep1Reply,validatePasswordLength:validatePasswordLength,validateUserIDLength:validateUserIDLength},module.exports={activate:activate,clean:clean,continueSession:continueSession,generateKeys:generateKeys,generateInitialSessionData:generateInitialSessionData,generateSecondarySessionData:generateSecondarySessionData,nextStep:nextStep,readSession:readSession,seedGenerator:seedGenerator,sessionStep1Reply:sessionStep1Reply,validatePasswordLength:validatePasswordLength,validateUserIDLength:validateUserIDLength}},function(e,n,r){var t=r(0),o=r(6),s=(r(1),r(3));e.exports={HybriddNode:function(e){var n,r,i,c,a,u,l=e;this.xAuthStep0Request=function(){return n=0,"/x/"+i.session_hexsign+"/0"},this.xAuthStep1Request=function(e){n=1;try{c=s.generateSecondarySessionData(e,i.session_hexkey,i.session_signpair.signSk)}catch(e){console.log("Error: "+JSON.stringify(e))}return"/x/"+i.session_hexsign+"/1/"+c.crypt_hex},this.xAuthFinalize=function(e,n){u=e;var t={userKeys:n,nonce:r};Object.assign(t,u,i,c),a=s.sessionStep1Reply(e,t,()=>{})},this.yCall=function(e,r,o){n++;var s=t.getGeneralSessionData({user_keys:e.userKeys,nonce:a.current_nonce},n,a.sess_hex),i=t.encode_sub({sessionID:s.sessionID,sessionNonce:s.sessionNonce,serverSessionPubKey:s.serverSessionPubKey,clientSessionSecKey:s.clientSessionSecKey,step:n,txtdata:e.query});this.call({query:e.channel+"/"+i,connector:e.connector,meta:!0},n=>{var i=t.decode_sub({encdata:n,sessionNonce:s.sessionNonce,serverSessionPubKey:s.serverSessionPubKey,clientSessionSecKey:s.clientSessionSecKey});if("y"===e.channel){try{e=JSON.parse(i)}catch(e){return console.error(e),void("function"==typeof o&&o(e))}r(e)}else r(i)},o)},this.zCall=function(e,r,t){var s=o.encode({user_keys:e.userKeys,nonce:a.current_nonce},n,e.query);this.yCall({query:s,channel:"z",userKeys:e.userKeys,connector:e.connector},e=>{var n,s=o.decode_sub(e);try{n=JSON.parse(s)}catch(e){return console.error(e),void("function"==typeof t&&t(e))}r(n)},t)},this.call=function(e,n,r){var t,o=!!e.meta;try{XMLHttpRequest}catch(e){e.name}try{http}catch(e){e.name}if(e.connector.hasOwnProperty("XMLHttpRequest")&&(t=((n,r,t,o)=>{var s=new e.connector.XMLHttpRequest;s.onreadystatechange=(e=>{4===s.readyState&&(200===s.status?t(s.responseText):(console.error(s.responseText),"function"==typeof o&&o(s.responseText)))}),s.open("GET",n+r,!0),s.send()})),e.connector.hasOwnProperty("http")&&(t=((n,r,t,o)=>{e.connector.http.get(n+r,e=>{const{statusCode:n}=e;let r;if(200!==n&&(r="Request error: Status Code: "+n),r)return console.error(r),"function"==typeof o&&o(r),void e.resume();e.setEncoding("utf8");let s="";e.on("data",e=>{s+=e}),e.on("end",()=>{t(s)})}).on("error",e=>{console.error(`Got error: ${e.message}`),"function"==typeof o&&o(`Got error: ${e.message}`)})})),e.connector.hasOwnProperty("custom")&&(t=e.connector.custom),void 0===t)return console.error("Error: No http request connector method available."),void("function"==typeof r&&r("Error: No http request connector method available."));t(l,e.query,e=>{var s;try{s=JSON.parse(e)}catch(e){return console.error(e),void("function"==typeof r&&r(e))}if(s.hasOwnProperty("id")&&"id"===s.id)var i=setInterval(()=>{t(l,"/proc/"+s.data,e=>{var t;try{t=JSON.parse(e)}catch(e){return console.error(e),clearInterval(i),void("function"==typeof r&&r(e))}t.hasOwnProperty("error")&&0!==t.error?(console.error(t),clearInterval(i),"function"==typeof r&&r(t.info)):null!==t.stopped&&(clearInterval(i),n(o?t:t.data))})},500);else if(n){if(s.hasOwnProperty("error")&&0!==s.error)return console.error(s),void("function"==typeof r&&r(e));n(o?s:s.data)}},r)},this.init=function(e,n,t){r=nacl.crypto_box_random_nonce(),i=s.generateInitialSessionData(r),this.call({query:this.xAuthStep0Request(),connector:e.connector,meta:!0},r=>{this.call({query:this.xAuthStep1Request(r.nonce1),connector:e.connector,meta:!0},r=>{this.xAuthFinalize(r,e.userKeys),n&&n()},t,e.option)},t,e.options)}}}},function(e,n,r){var t,o=r(2);o.set({precision:64});var s=function(){function e(e,n,r){for(var t=[],o=Math.max(e.length,n.length),s=0,i=0;i<o||s;){var c=s+(i<e.length?e[i]:0)+(i<n.length?n[i]:0);t.push(c%r),s=Math.floor(c/r),i++}return t}function n(n,r,t){if(n<0)return null;if(0==n)return[];for(var o=[],s=r;1&n&&(o=e(o,s,t)),0!=(n>>=1);)s=e(s,s,t);return o}function r(r,t,o){var s=function(e,n){for(var r=e.split(""),t=[],o=r.length-1;o>=0;o--){var s=parseInt(r[o],n);if(isNaN(s))return null;t.push(s)}return t}(r,t);if(null===s)return null;for(var i=[],c=[1],a=0;a<s.length;a++)s[a]&&(i=e(i,n(s[a],c,o),o)),c=n(t,c,o);var u="";for(a=i.length-1;a>=0;a--)u+=i[a].toString(o);return u}return{toHex:function(e){var n=r(String(e),10,16);return n?"0x"+n:null},toDec:function(e){if(e)"0x"===e.substring(0,2)&&(e=e.substring(2)),n=r(e=e.toLowerCase(),16,10);else var n=0;return new o(n||0)}}}();void 0===(t=function(){return s}.call(n,r,n,e))||(e.exports=t)},function(e,n,r){var t=r(0),o=r(7),s=function(e,n,r){return o.compressToEncodedURIComponent(r)},i=function(e,n,r){return t.ychan_decode(e,n,r)};e.exports={path:function(e,n,r){return"z/"+t.encode(e,n,s(0,0,r))},obj:function(e,n,r){try{return JSON.parse(i(e,n,r))}catch(e){return!1}},encode:s,decode_sub:function(e){return o.decompressFromEncodedURIComponent(e)},decode:i}},function(e,n,r){var t,o=function(){var e=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",t={};function o(e,n){if(!t[e]){t[e]={};for(var r=0;r<e.length;r++)t[e][e.charAt(r)]=r}return t[e][n]}var s={compressToBase64:function(e){if(null==e)return"";var r=s._compress(e,6,function(e){return n.charAt(e)});switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:s._decompress(e.length,32,function(r){return o(n,e.charAt(r))})},compressToUTF16:function(n){return null==n?"":s._compress(n,15,function(n){return e(n+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:s._decompress(e.length,16384,function(n){return e.charCodeAt(n)-32})},compressToUint8Array:function(e){for(var n=s.compress(e),r=new Uint8Array(2*n.length),t=0,o=n.length;t<o;t++){var i=n.charCodeAt(t);r[2*t]=i>>>8,r[2*t+1]=i%256}return r},decompressFromUint8Array:function(n){if(null===n||void 0===n)return s.decompress(n);for(var r=new Array(n.length/2),t=0,o=r.length;t<o;t++)r[t]=256*n[2*t]+n[2*t+1];var i=[];return r.forEach(function(n){i.push(e(n))}),s.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":s._compress(e,6,function(e){return r.charAt(e)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),s._decompress(e.length,32,function(n){return o(r,e.charAt(n))}))},compress:function(n){return s._compress(n,16,function(n){return e(n)})},_compress:function(e,n,r){if(null==e)return"";var t,o,s,i={},c={},a="",u="",l="",f=2,h=3,d=2,p=[],g=0,v=0;for(s=0;s<e.length;s+=1)if(a=e.charAt(s),Object.prototype.hasOwnProperty.call(i,a)||(i[a]=h++,c[a]=!0),u=l+a,Object.prototype.hasOwnProperty.call(i,u))l=u;else{if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(t=0;t<d;t++)g<<=1,v==n-1?(v=0,p.push(r(g)),g=0):v++;for(o=l.charCodeAt(0),t=0;t<8;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1}else{for(o=1,t=0;t<d;t++)g=g<<1|o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o=0;for(o=l.charCodeAt(0),t=0;t<16;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1}0==--f&&(f=Math.pow(2,d),d++),delete c[l]}else for(o=i[l],t=0;t<d;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1;0==--f&&(f=Math.pow(2,d),d++),i[u]=h++,l=String(a)}if(""!==l){if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(t=0;t<d;t++)g<<=1,v==n-1?(v=0,p.push(r(g)),g=0):v++;for(o=l.charCodeAt(0),t=0;t<8;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1}else{for(o=1,t=0;t<d;t++)g=g<<1|o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o=0;for(o=l.charCodeAt(0),t=0;t<16;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1}0==--f&&(f=Math.pow(2,d),d++),delete c[l]}else for(o=i[l],t=0;t<d;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1;0==--f&&(f=Math.pow(2,d),d++)}for(o=2,t=0;t<d;t++)g=g<<1|1&o,v==n-1?(v=0,p.push(r(g)),g=0):v++,o>>=1;for(;;){if(g<<=1,v==n-1){p.push(r(g));break}v++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:s._decompress(e.length,32768,function(n){return e.charCodeAt(n)})},_decompress:function(n,r,t){var o,s,i,c,a,u,l,f=[],h=4,d=4,p=3,g="",v=[],y={val:t(0),position:r,index:1};for(o=0;o<3;o+=1)f[o]=o;for(i=0,a=Math.pow(2,2),u=1;u!=a;)c=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=t(y.index++)),i|=(c>0?1:0)*u,u<<=1;switch(i){case 0:for(i=0,a=Math.pow(2,8),u=1;u!=a;)c=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=t(y.index++)),i|=(c>0?1:0)*u,u<<=1;l=e(i);break;case 1:for(i=0,a=Math.pow(2,16),u=1;u!=a;)c=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=t(y.index++)),i|=(c>0?1:0)*u,u<<=1;l=e(i);break;case 2:return""}for(f[3]=l,s=l,v.push(l);;){if(y.index>n)return"";for(i=0,a=Math.pow(2,p),u=1;u!=a;)c=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=t(y.index++)),i|=(c>0?1:0)*u,u<<=1;switch(l=i){case 0:for(i=0,a=Math.pow(2,8),u=1;u!=a;)c=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=t(y.index++)),i|=(c>0?1:0)*u,u<<=1;f[d++]=e(i),l=d-1,h--;break;case 1:for(i=0,a=Math.pow(2,16),u=1;u!=a;)c=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=t(y.index++)),i|=(c>0?1:0)*u,u<<=1;f[d++]=e(i),l=d-1,h--;break;case 2:return v.join("")}if(0==h&&(h=Math.pow(2,p),p++),f[l])g=f[l];else{if(l!==d)return null;g=s+s.charAt(0)}v.push(g),f[d++]=s+g.charAt(0),s=g,0==--h&&(h=Math.pow(2,p),p++)}}};return s}();void 0===(t=function(){return o}.call(n,r,n,e))||(e.exports=t)}]);
